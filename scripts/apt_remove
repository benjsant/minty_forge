#!/bin/bash
# MintyForge - Remove unwanted APT packages

set -e

# -------- Terminal Colors --------
GREEN="\e[32m"
YELLOW="\e[33m"
BLUE="\e[34m"
RESET="\e[0m"

info() { echo -e "${BLUE}[INFO]${RESET} $1"; }
success() { echo -e "${GREEN}[OK]${RESET} $1"; }
warn() { echo -e "${YELLOW}[WARN]${RESET} $1"; }

CONFIG_FILE="configs/remove.txt"

if [ ! -f "$CONFIG_FILE" ]; then
    echo "Remove config file $CONFIG_FILE not found!"
    exit 1
fi

info "Removing unwanted APT packages from $CONFIG_FILE..."

while IFS= read -r pkg || [ -n "$pkg" ]; do
    # Skip empty lines and comments
    [[ -z "$pkg" || "$pkg" =~ ^# ]] && continue

    if dpkg -s "$pkg" &> /dev/null; then
        info "Removing $pkg..."
        sudo apt purge -y "$pkg"
        success "$pkg removed."
    else
        warn "$pkg is not installed, skipping..."
    fi
done < "$CONFIG_FILE"

info "Running autoremove to clean dependencies..."
sudo apt autoremove -y
success "Unwanted packages removal completed."
